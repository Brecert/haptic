const l=[];let s,u;function h(n){const e=(...t)=>{if(!t.length)return s&&!e.cs.has(s)&&(e.cs.add(s),s.ws.push(e)),n;const[a]=t;if(u)return e.pending===l&&u.push(e),e.pending=a,a;n=a;const o=s;return s=void 0,e.csRun=new Set(e.cs),e.csRun.forEach(i=>{i.stale=!0}),e.csRun.forEach(i=>{i.stale&&i()}),s=o,n};return e.$o=1,e.cs=new Set,e.csRun=void 0,e.pending=l,e}function c(n){let e;const t=()=>(t.stale?e=g(t,n):s&&t.ws.forEach(a=>{a()}),e);return t.$o=1,t.stale=!0,t.ws=[],t.csNested=[],t(),t}function g(n,e){const t=s;s&&s.csNested.push(n);const a=n.csNested;d(n),n.stale=!1,s=n;const o=e();a.forEach(r=>{n.csNested.indexOf(r)===-1&&(r.stale=!1)});let i;const p=[].concat(n.csNested);for(;i=p.pop();)i.stale||i.ws.forEach(r=>{r.csRun&&r.csRun.delete(i)}),i.csNested.forEach(r=>p.push(r));return s=t,o}function m(n){const e=c(n);return()=>d(e)}function d(n){n.csNested.forEach(d),n.ws.forEach(e=>{e.cs.delete(n),e.csRun&&e.csRun.delete(n)}),n.ws=[],n.csNested=[]}function S(n){const e=u;u=[];const t=n(),a=u;return u=e,a.forEach(o=>{if(o.pending!==l){const{pending:i}=o;o.pending=l,o(i)}}),t}function f(n){const e=s;s=void 0;const t=n();return s=e,t}function T(n,e,t={onlyChanges:!0}){return n=[].concat(n),c(()=>{n.forEach(o=>{o()});let a;return t.onlyChanges||(a=f(e)),t.onlyChanges=!1,a})}export{c,c as computed,T as on,h as s,f as sample,h as signal,m as subscribe,S as transaction,d as unsubscribe};
//# sourceMappingURL=index.js.map
